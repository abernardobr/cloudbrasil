<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for security/domains/helpers/modules/redis.js</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../../../../prettify.css" />
    <link rel="stylesheet" href="../../../../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../../../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../../../../index.html">all files</a> / <a href="index.html">security/domains/helpers/modules/</a> redis.js
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">89.6% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>112/125</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">57.14% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>16/28</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">100% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>18/18</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">89.6% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>112/125</span>
      </div>
    </div>
  </div>
  <div class='status-line high'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385</td><td class="line-coverage quiet"><span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">50×</span>
<span class="cline-any cline-yes">50×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">7×</span>
<span class="cline-any cline-yes">7×</span>
<span class="cline-any cline-yes">7×</span>
<span class="cline-any cline-yes">7×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">19×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">19×</span>
<span class="cline-any cline-yes">19×</span>
<span class="cline-any cline-yes">19×</span>
<span class="cline-any cline-yes">19×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">8×</span>
<span class="cline-any cline-yes">8×</span>
<span class="cline-any cline-yes">8×</span>
<span class="cline-any cline-yes">8×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">const _ = require('lodash');
const Joi = require('joi');
const RedisCli = require('redis');
&nbsp;
/**
 * Class to connect and call Redis
 * @class
 */
class Redis {
&nbsp;
    /**
     *
     * @param options
     *  - dbId (required): the database id to be used for Redis.
     *  - port (required, default: 6379): the port that Redis is running.
     *  - host (required, default: localhost): the host that Redis is running.
     *  - prefix (required, default: redis): the prefix that will be added to every key for the key:value pair of a redis entry
     *  - config: (required, default: {}): the basic configuration to start redis (https://github.com/NodeRedis/node_redis#rediscreateclient)
     *
     * @constructor
     */
    constructor(options) {
        const self = this;
        self.options = _.defaultsDeep(options, {
            prefix: 'redis',
            dbId: 1,
            config: {
                port: 6379,
                host: 'localhost',
            }
        });
        self.client = RedisCli.createClient(self.options.config);
&nbsp;
        Joi.assert(self.options, Joi.object().required());
        Joi.assert(self.options.prefix, Joi.string().min(3).max(10).required());
        Joi.assert(self.options.dbId, Joi.number().min(1).max(10).required());
        Joi.assert(self.options.config, Joi.object().required());
        Joi.assert(self.options.config.port, Joi.number().required());
        Joi.assert(self.options.config.host, Joi.string().required());
&nbsp;
        self.status = 'disconnected';        // can be disconnected, connecting, connected, ready
        self.prefix = false;
    }
&nbsp;
    /**
     * Creates an id for the key on a key:value pair.
     * @param id
     *  - The id to create for the redis key for a key:value pair
     * @returns {string}
     *  - The new id pre-pented with the prefix. The separator is ':', which is the standard key separator on Redis
     * @private
     */
    _createId(id) {
        const self = this;
        return `${self.options.prefix}:${id}`;
    }
&nbsp;
    /**
     * Starts Redis according to the config set during the options
     * @param cb
     */
    connect(cb) {
        let self = this;
&nbsp;
        <span class="missing-if-branch" title="if path not taken" >I</span>if(self.status !== 'disconnected') {
<span class="cstat-no" title="statement not covered" >            cb();</span>
<span class="cstat-no" title="statement not covered" >            return;</span>
        }
&nbsp;
        let options = self.options;
        Joi.assert(options.dbId, Joi.number().min(1).max(10).required());
&nbsp;
        self.client.select(options.dbId);
        self.client.on('ready', (err) =&gt; {
            <span class="missing-if-branch" title="if path not taken" >I</span>if(err) {
<span class="cstat-no" title="statement not covered" >                console.log(`*** Redis ready error ${err}`);</span>
<span class="cstat-no" title="statement not covered" >                self.status = 'disconnected';</span>
            } else {
                self.status = 'ready';
                self.prefix = `${self.options.prefix}:`;
                console.log('*** Redis ready');
            }
            <span class="missing-if-branch" title="else path not taken" >E</span>if(cb) {
                cb(err);
            }
        });
        self.client.on('connect', (err) =&gt; {
            <span class="missing-if-branch" title="if path not taken" >I</span>if(err) {
<span class="cstat-no" title="statement not covered" >                console.log(`*** Redis connect error ${err}`);</span>
<span class="cstat-no" title="statement not covered" >                self.status = 'disconnected';</span>
            } else {
                console.log('*** Redis connect');
                self.status = 'connected';
            }
        });
        self.client.on('end', (err) =&gt; {
            self.status = 'disconnected';
            <span class="missing-if-branch" title="if path not taken" >I</span>if(err) {
<span class="cstat-no" title="statement not covered" >                console.log(`*** Redis end error ${err}`);</span>
            } else {
                console.log('*** Redis end');
            }
        });
    }
&nbsp;
    /**
     * This sends the quit command to the redis server and ends cleanly right after all running commands were properly handled.
     * If this is called while reconnecting (and therefor no connection to the redis server exists) it is going to end the connection
     * right away instead of resulting in further reconnections! All offline commands are going to be flushed with an error in that case.
     */
    quit() {
        const self = this;
        <span class="missing-if-branch" title="else path not taken" >E</span>if(self.connected !== 'disconnected') {
            self.client.quit();
        }
    }
&nbsp;
    /**
     * Sets the given string as value and id as key for the key:value pair.
     * @param id
     *  - the id for the key on a key:value pair
     * @param data
     *  - the data, in string format, that will be set for the value on a key:value pair
     */
    set(id, data) {
        Joi.assert(id, Joi.string().min(2).required());
        Joi.assert(data, Joi.string().required());
&nbsp;
        const self = this;
        self.client.SET(self._createId(id), data, (err) =&gt; {
            <span class="missing-if-branch" title="if path not taken" >I</span>if(err) {
<span class="cstat-no" title="statement not covered" >                console.log(err);</span>
            }
        });
    }
&nbsp;
    /**
     * Sets a new TTL on the key
     * @param id
     *  - the id for the key on a key:value pair
     * @param timeInSec
     *  - the time in seconds for expiration on the key:value pair. After the given time, this entry will be delete from the database
     */
    expire(id, timeInSec) {
        Joi.assert(id, Joi.string().min(2).required());
        Joi.assert(timeInSec, Joi.number().min(1).required());
&nbsp;
        const self = this;
        self.client.EXPIRE(self._createId(id), timeInSec);
    }
&nbsp;
    /**
     * Sets, for a given time in seconds, the given satring as value and id as key for the key:value pair.
     * @param id
     *  - the id for the key on a key:value pair
     * @param data
     *  - the data, in string format, that will be set for the value on a key:value pair
     * @param timeInSec
     *  - the time in seconds for expiration on the key:value pair. After the given time, this entry will be delete from the database
     */
    setEX(id, data, timeInSec) {
        Joi.assert(id, Joi.string().min(2).required());
        Joi.assert(data, Joi.string().required());
        Joi.assert(timeInSec, Joi.number().min(1).required());
&nbsp;
        const self = this;
        self.client.SETEX(self._createId(id), timeInSec, data, (err) =&gt; {
            <span class="missing-if-branch" title="if path not taken" >I</span>if(err) {
<span class="cstat-no" title="statement not covered" >                console.log(err);</span>
            }
        });
    }
&nbsp;
    /**
     * Sets the given object as value and id as key for the key:value pair. The object is saved as a string.
     * @param id
     *  - the id for the key on a key:value pair
     * @param obj
     *  - the object that will be set as a string for the value on a key:value pair
     */
    setObj(id, obj) {
        Joi.assert(id, Joi.string().min(2).required());
        Joi.assert(obj, Joi.object().required());
&nbsp;
        const self = this;
        const sessionData = JSON.stringify(obj);
&nbsp;
        self.client.SET(self._createId(id), sessionData, (err) =&gt; {
            <span class="missing-if-branch" title="if path not taken" >I</span>if(err) {
<span class="cstat-no" title="statement not covered" >                console.log(err);</span>
            }
        });
    }
&nbsp;
    /**
     * Sets, for a given time in seconds, the given object as value and id as key for the key:value pair. The object is saved as a string.
     * @param id
     *  - the id for the key on a key:value pair
     * @param obj
     *  - the object that will be set as a string for the value on a key:value pair
     * @param timeInSec
     *  - the time in seconds for expiration on the key:value pair. After the given time, this entry will be delete from the database
     */
    setObjEX(id, obj, timeInSec) {
        Joi.assert(id, Joi.string().min(2).required());
        Joi.assert(obj, Joi.object().required());
        Joi.assert(timeInSec, Joi.number().min(1).required());
&nbsp;
        const self = this;
        const sessionData = JSON.stringify(obj);
        self.client.SETEX(self._createId(id), timeInSec, sessionData, (err) =&gt; {
            <span class="missing-if-branch" title="if path not taken" >I</span>if(err) {
<span class="cstat-no" title="statement not covered" >                console.log(err);</span>
            }
        });
    }
&nbsp;
    /**
     * Gets the value as string, for a given key on a key:value pair
     * @param id
     *  - the id for the key on a key:value pair
     * @param cb
     *  - err: the error of the function, if not errors, null or undefined
     *  - retData: return the value as a string, retrieved from a key:value pair
     */
    get(id, cb) {
        Joi.assert(id, Joi.string().min(2).required());
        const self = this;
        self.client.GET(self._createId(id), (err, retData) =&gt; {
            cb(err, retData);
        });
    }
&nbsp;
    /**
     * Gets the value as object, for a given key on a key:value pair
     * @param id
     *  - the id for the key on a key:value pair
     * @param cb
     *  - err: the error of the function, if not errors, null or undefined
     *  - obj: return the value as an object, retrieved from a key:value pair
     */
    getObj(id, cb) {
        Joi.assert(id, Joi.string().min(2).required());
&nbsp;
        const self = this;
        self.client.GET(self._createId(id), (err, retData) =&gt; {
            let obj = JSON.parse(retData);
            cb(err, obj);
        });
    }
&nbsp;
    /**
     * Deletes the key:value pair, given the id as the key.
     * @param id
     * @param cb
     */
    del(id, cb) {
        Joi.assert(id, Joi.string().min(2).required());
        const self = this;
        self.client.DEL(self._createId(id), (err) =&gt; {
            if(cb) {
                cb(err);
            }
        });
    }
&nbsp;
    /**
     * Sets the field value for a hash key:value pair where the obj is an JSON object
     * @param id
     *  - the id for the key on a key:value pair
     * @param field
     *  - the field from the id for the key on a key:value pair. That is, for the hash, id and field will return the value
     * @param data
     *  - the string data that will be set for the value on a key(field):value pair
     */
    hset(id, field, data) {
        Joi.assert(id, Joi.string().min(2).required());
        Joi.assert(field, Joi.string().min(2).required());
&nbsp;
        const self = this;
        self.client.HSET(id, field, data, (err) =&gt; {
            <span class="missing-if-branch" title="if path not taken" >I</span>if(err) {
<span class="cstat-no" title="statement not covered" >                console.log(err);</span>
            }
        });
    }
&nbsp;
    /**
     * Sets the field value for a hash key:value pair where the obj is an JSON object
     * @param id
     *  - the id for the key on a key:value pair
     * @param field
     *  - the field from the id for the key on a key:value pair. That is, for the hash, id and field will return the value
     * @param obj
     *  - the object that will be set as a string for the value on a key(field):value pair
     */
    hsetObj(id, field, obj) {
        Joi.assert(id, Joi.string().min(2).required());
        Joi.assert(field, Joi.string().min(2).required());
&nbsp;
        const self = this;
        const hashData = JSON.stringify(obj);
        self.client.HSET(id, field, hashData, (err) =&gt; {
            <span class="missing-if-branch" title="if path not taken" >I</span>if(err) {
<span class="cstat-no" title="statement not covered" >                console.log(err);</span>
            }
        });
    }
&nbsp;
    /**
     * Get the field value for a hash key:value pair and return as a string.
     * @param id
     *  - the id for the key on a key:value pair
     * @param field
     *  - the field from the id for the key on a key:value pair. That is, for the hash, id and field will return the value
     * @param cb
     *  - err: the error of the function, if not errors, null or undefined
     *  - retData: return the value as a string, retrieved from a key(field):value pair
     */
    hget(id, field, cb) {
        Joi.assert(id, Joi.string().min(2).required());
        Joi.assert(field, Joi.string().min(2).required());
&nbsp;
        const self = this;
        self.client.HGET(self._createId(id), field, (err, retData) =&gt; {
            cb(err, retData);
        });
    }
&nbsp;
    /**
     * Get the field value for a hash key:value pair and return as an object parsed from ther string.
     * @param id
     *  - the id for the key on a key:value pair
     * @param field
     *  - the field from the id for the key on a key:value pair. That is, for the hash, id and field will return the value
     * @param cb
     *  - err: the error of the function, if not errors, null or undefined
     *  - retData: return the value as an object, retrieved from a key(field):value pair
     */
    hgetObj(id, field, cb) {
        Joi.assert(id, Joi.string().min(2).required());
        Joi.assert(field, Joi.string().min(2).required());
&nbsp;
        const self = this;
        self.client.HGET(self._createId(id), field, (err, retData) =&gt; {
            const obj = JSON.parse(retData);
            cb(err, obj);
        });
    }
&nbsp;
    /**
     * Deletes the specific hash from the id and field on a key{field}:value pair.
     * @param id
     *  - the id for the key on a key:value pair
     * @param field
     *  - the field from the id for the key on a key:value pair. That is, for the hash, id and field will return the value
     * @param cb
     *  cb is not required. But in case you want to control that it delete, you provide a callback
     *  - err: the error of the function, if not errors, null or undefined
     */
    hdel(id, field, cb) {
        Joi.assert(id, Joi.string().min(2).required());
        Joi.assert(field, Joi.string().min(2).required());
&nbsp;
        const self = this;
        self.client.HDEL(id, field, (err) =&gt; {
            if(cb) {
                cb(err);
            }
        });
    }
&nbsp;
    /**
     * Returns the direct client so that it is possible to manipulate directly the redis client
     * @returns {*}
     */
    DIRECT() {
        let self = this;
        return self.client;
    }
}
&nbsp;
module.exports = Redis;
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Thu Jul 06 2017 23:25:01 GMT+0100 (IST)
</div>
</div>
<script src="../../../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../../../sorter.js"></script>
</body>
</html>
